{"version":3,"sources":["webpack:///./resources/js/pages/user.js"],"names":["$","ajaxSetup","headers","attr","fn","modal","Constructor","prototype","_enforceFocus","tableUser","DataTable","order","processing","serverSide","ajax","url","base_url","dataType","type","data","dataFilter","columnsFilter","val","filterVal","jenis_data","error","jqXHR","textStatus","errorThrown","responseJSON","Swal","fire","icon","title","html","allowOutsideClick","showConfirmButton","then","refreshTable","message","errorLine","line","file","columns","columnDefs","orderable","targets","search","draw","off","on","e","code","this","value","btnReloadUser","document","getElementById","openForm","show","backdrop","keyboard","closeForm","reset","trigger","remove","addEventListener","input","review","linkFoto","files","reader","FileReader","onload","target","result","next","name","readAsDataURL","readURL","select2","theme","placeholder","allowClear","preventDefault","imageUrl","imageHeight","formData","FormData","contentType","processData","success","meta","timer","dataUser","user","self","foto","errorValidator","errors","li","each","key","footer","idUser","urlEdit","x","action","appendTo","username","email","role","close","text","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","urlDelete","_method"],"mappings":"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","file":"/js/pages/user.js","sourcesContent":["$(function () {\n    $.ajaxSetup({\n        headers: {\n            \"X-CSRF-TOKEN\": $('meta[name=\"csrf-token\"').attr(\"content\"),\n        },\n    });\n    $.fn.modal.Constructor.prototype._enforceFocus = function () {};\n\n    var columnsTable = [\n        { data: \"no\" },\n        { data: \"foto\" },\n        { data: \"name\" },\n        { data: \"email\" },\n        { data: \"username\" },\n        { data: \"role\" },\n        { data: \"created_at\" },\n        { data: \"action\" },\n    ];\n\n    var tableUser = $(\"#table-user\").DataTable({\n        // \"searching\": false,\n        order: [[0, \"DESC\"]],\n        processing: true,\n        serverSide: true,\n        ajax: {\n            url: base_url + \"/user/datatable\",\n            dataType: \"json\",\n            type: \"POST\",\n            data: function (dataFilter) {\n                var columnsFilter = $(\"#columnsFilter\").val();\n                var filterVal = $(\"#filterVal\").val();\n                var jenis_data = $(\"#jenis_data\").val();\n\n                dataFilter.columnsFilter = columnsFilter;\n                dataFilter.filterVal = filterVal;\n                dataFilter.jenis_data = jenis_data;\n            },\n            error: function (jqXHR, textStatus, errorThrown) {\n                if (jqXHR.responseJSON.data) {\n                    var error = jqXHR.responseJSON.data.error;\n                    Swal.fire({\n                        icon: \"error\",\n                        title: \" <br>Copy error dan hubungi Programmer!\",\n                        html:\n                            '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                            \"<p>Error Message: <strong>\" +\n                            error +\n                            \"</strong></p>\" +\n                            \"</div>\",\n                        allowOutsideClick: false,\n                        showConfirmButton: true,\n                    }).then(function () {\n                        refreshTable();\n                    });\n                } else {\n                    var message = jqXHR.responseJSON.message;\n                    var errorLine = jqXHR.responseJSON.line;\n                    var file = jqXHR.responseJSON.file;\n                    Swal.fire({\n                        icon: \"error\",\n                        title: \" <br>Copy error dan hubungi Programmer!\",\n                        html:\n                            '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                            \"<p>Error Message: <strong>\" +\n                            message +\n                            \"</strong></p>\" +\n                            \"<p>File: \" +\n                            file +\n                            \"</p>\" +\n                            \"<p>Line: \" +\n                            errorLine +\n                            \"</p>\" +\n                            \"</div>\",\n                        allowOutsideClick: false,\n                        showConfirmButton: true,\n                    }).then(function () {\n                        refreshTable();\n                    });\n                }\n            },\n        },\n\n        columns: columnsTable,\n        columnDefs: [\n            {\n                orderable: false,\n                targets: [0, 1, -1],\n            },\n        ],\n    });\n    $(\"#table-user_filter input\").off();\n    $(\"#table-user_filter input\").on(\"keyup\", function (e) {\n        if (e.code == \"Enter\") {\n            tableUser.search(this.value).draw();\n        }\n    });\n\n    function refreshTable() {\n        tableUser.search(\"\").draw();\n    }\n\n    var btnReloadUser = document.getElementById(\"btn-userReload\");\n    if (btnReloadUser) {\n        btnReloadUser.addEventListener(\"click\", function () {\n            refreshTable();\n        });\n    }\n\n    /** ./end datatable */\n\n    $(\"#inputFoto\").on(\"change\", function () {\n        var review = \"imageReview\";\n        var linkFoto = \"linkFoto\";\n        readURL(this, review, linkFoto);\n    });\n\n    function readURL(input, review, linkFoto) {\n        if (input.files && input.files[0]) {\n            var reader = new FileReader();\n\n            reader.onload = function (e) {\n                $(\"#\" + review).attr(\"src\", e.target.result);\n                $(\"#\" + linkFoto).attr(\"href\", e.target.result);\n                $(input).next(\".custom-file-label\").html(input.files[0].name);\n            };\n\n            reader.readAsDataURL(input.files[0]); // convert to base64 string\n        }\n    }\n\n    function formReset() {\n        $(\"#formUser\")[0].reset();\n        $(\"#formUser\").attr(\"action\", base_url + \"/user\");\n        $(\"#role\").val(\"\").trigger(\"change\");\n        $('[name=\"_method\"]').remove();\n        $(\"#imageReview\").attr(\"src\", base_url + \"/images/no-image.png\");\n        $(\"#linkFoto\").attr(\"href\", base_url + \"/images/no-image.png\");\n\n        $(\"#modalFormInputLabel\").html(\n            '<i class=\"fas fa-user-plus\"></i>&nbsp; Add User'\n        );\n    }\n\n    $(\".openForm\").on(\"click\", function () {\n        openForm();\n    });\n\n    $(\".closeForm\").on(\"click\", function () {\n        closeForm();\n    });\n\n    function openForm() {\n        $(\"#modalFormInput\").modal({\n            show: true,\n            backdrop: \"static\",\n            keyboard: false, // to prevent closing with Esc button (if you want this too)\n        });\n    }\n\n    function closeForm() {\n        $(\"#modalFormInput\").modal(\"hide\");\n        formReset();\n    }\n\n    $(\"#role\").select2({\n        theme: \"bootstrap4\",\n        placeholder: \"Select Role\",\n        allowClear: true,\n    });\n\n    $(\"#formUser\").on(\"submit\", function (e) {\n        e.preventDefault();\n        Swal.fire({\n            imageUrl: base_url + \"/images/loading.gif\",\n            imageHeight: 300,\n            showConfirmButton: false,\n            title: \"Loading ...\",\n            allowOutsideClick: false,\n        });\n        var formData = new FormData($(\"#formUser\")[0]);\n        var url = $(\"#formUser\").attr(\"action\");\n        $.ajax({\n            url: url,\n            type: \"POST\",\n            data: formData,\n            contentType: false,\n            processData: false,\n            dataType: \"JSON\",\n            success: function (data) {\n                Swal.fire({\n                    icon: \"success\",\n                    title: data.meta.message,\n                    showConfirmButton: false,\n                    timer: 2000,\n                    allowOutsideClick: false,\n                }).then(function () {\n                    var dataUser = data.data.user;\n\n                    var self = data.data.self;\n\n                    if (self == true) {\n                        $(\"#userImageSide\").attr(\n                            \"src\",\n                            base_url + \"/storage/\" + dataUser.foto\n                        );\n                        $(\"#userNameSide\").html(dataUser.name);\n                    }\n\n                    refreshTable();\n\n                    closeForm();\n                });\n            },\n            error: function (jqXHR, textStatus, errorThrown) {\n                if (jqXHR.responseJSON.data.errorValidator) {\n                    var errors = jqXHR.responseJSON.data.errorValidator;\n                    var message = jqXHR.responseJSON.message;\n                    var li = \"\";\n                    $.each(errors, function (key, value) {\n                        li += \"<li>\" + value + \"</li>\";\n                    });\n\n                    Swal.fire({\n                        icon: \"error\",\n                        title: message,\n                        html:\n                            '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                            \"<ul>\" +\n                            li +\n                            \"</ul>\" +\n                            \"</div>\",\n                        footer: \"Pastikan data yang anda masukkan sudah benar!\",\n                        allowOutsideClick: false,\n                        showConfirmButton: true,\n                    });\n                } else {\n                    var message = jqXHR.responseJSON.meta.message;\n                    var data = jqXHR.responseJSON.data;\n\n                    Swal.fire({\n                        icon: \"error\",\n                        title:\n                            message + \" <br>Copy error dan hubungi Programmer!\",\n                        html:\n                            '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                            \"<p>Error Message: <strong>\" +\n                            message +\n                            \"</strong></p>\" +\n                            \"<p>Error: \" +\n                            data.error +\n                            \"</p>\" +\n                            \"</div>\",\n                        allowOutsideClick: false,\n                        showConfirmButton: true,\n                    });\n                }\n            },\n        });\n    });\n\n    /** Proses edit */\n    $(\"#table-user\").on(\"click\", \".btn-edit\", function () {\n        Swal.fire({\n            imageUrl: base_url + \"/images/loading.gif\",\n            imageHeight: 300,\n            showConfirmButton: false,\n            title: \"Loading ...\",\n            allowOutsideClick: false,\n        });\n\n        var idUser = $(this).data(\"id\");\n        var urlEdit = base_url + \"/user/\" + idUser + \"/edit\";\n\n        $.ajax({\n            url: urlEdit,\n            type: \"get\",\n            success: function (x) {\n                var dataUser = x.data.user;\n\n                $(\"#formUser\").attr(\"action\", x.data.action);\n                $('<input name=\"_method\" value=\"patch\">')\n                    .attr(\"type\", \"hidden\")\n                    .appendTo(\"#formUser\");\n                $(\"#modalFormInputLabel\").html(\n                    '<i class=\"fas fa-edit\"></i>&nbsp; Edit User'\n                );\n\n                $(\"#imageReview\").attr(\"src\", dataUser.foto);\n                $(\"#linkFoto\").attr(\"href\", dataUser.foto);\n\n                $('[name=\"nama\"]').val(dataUser.name);\n                $('[name=\"username\"]').val(dataUser.username);\n                $('[name=\"email\"]').val(dataUser.email);\n                $(\"#role\").val(dataUser.role).trigger(\"change\");\n\n                openForm();\n                Swal.close();\n            },\n            error: function (jqXHR, textStatus, errorThrown) {\n                var meta = jqXHR.responseJSON.meta;\n                var data = jqXHR.responseJSON.data;\n\n                Swal.fire({\n                    icon: \"error\",\n                    title: meta.message,\n                    html:\n                        '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                        \"<p>\" +\n                        data.error +\n                        \"</p>\" +\n                        \"</div>\",\n                    allowOutsideClick: false,\n                });\n            },\n        });\n    });\n\n    /** delete user */\n\n    $(\"#table-user\").on(\"click\", \".btn-delete\", function () {\n        closeForm();\n        Swal.fire({\n            title: \"Anda yakin?\",\n            text: \"Anda yakin ingin menghapus data?\",\n            icon: \"warning\",\n            showCancelButton: true,\n            confirmButtonColor: \"#3085d6\",\n            cancelButtonColor: \"#d33\",\n            confirmButtonText: \"Yes, delete it!\",\n            allowOutsideClick: false,\n        }).then((result) => {\n            if (result.value) {\n                Swal.fire({\n                    imageUrl: base_url + \"/images/loading.gif\",\n                    imageHeight: 300,\n                    showConfirmButton: false,\n                    title: \"Loading ...\",\n                    allowOutsideClick: false,\n                });\n\n                var idUser = $(this).data(\"id\");\n                var urlDelete = base_url + \"/user/\" + idUser + \"/delete\";\n                $.ajax({\n                    url: urlDelete,\n                    type: \"POST\",\n                    data: {\n                        _method: \"delete\",\n                    },\n                    dataType: \"JSON\",\n                    success: function (data) {\n                        Swal.fire({\n                            icon: \"success\",\n                            title: data.data.message,\n                            showConfirmButton: false,\n                            timer: 2000,\n                            allowOutsideClick: false,\n                        }).then(function () {\n                            refreshTable();\n                        });\n                    },\n                    error: function (jqXHR, textStatus, errorThrown) {\n                        var error = jqXHR.responseJSON;\n\n                        if (error.meta) {\n                            var message = error.meta.message;\n                        } else {\n                            var message = error.message;\n                        }\n                        Swal.fire({\n                            icon: \"error\",\n                            title: message,\n                            showConfirmButton: false,\n                            timer: 2000,\n                            allowOutsideClick: false,\n                        });\n                    },\n                });\n            }\n        });\n    });\n}); // ./end document\n"],"sourceRoot":""}