$((function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"').attr("content")}}),$.fn.modal.Constructor.prototype._enforceFocus=function(){};var e=$("#table-user").DataTable({order:[[0,"DESC"]],processing:!0,serverSide:!0,ajax:{url:base_url+"/user/datatable",dataType:"json",type:"POST",data:function(e){var a=$("#columnsFilter").val(),t=$("#filterVal").val(),r=$("#jenis_data").val();e.columnsFilter=a,e.filterVal=t,e.jenis_data=r},error:function(e,t,r){if(e.responseJSON.data){var o=e.responseJSON.data.error;Swal.fire({icon:"error",title:" <br>Copy error dan hubungi Programmer!",html:'<div class="alert alert-danger text-left" role="alert"><p>Error Message: <strong>'+o+"</strong></p></div>",allowOutsideClick:!1,showConfirmButton:!0}).then((function(){a()}))}else{var n=e.responseJSON.message,i=e.responseJSON.line,l=e.responseJSON.file;Swal.fire({icon:"error",title:" <br>Copy error dan hubungi Programmer!",html:'<div class="alert alert-danger text-left" role="alert"><p>Error Message: <strong>'+n+"</strong></p><p>File: "+l+"</p><p>Line: "+i+"</p></div>",allowOutsideClick:!1,showConfirmButton:!0}).then((function(){a()}))}}},columns:[{data:"no"},{data:"foto"},{data:"name"},{data:"email"},{data:"username"},{data:"role"},{data:"created_at"},{data:"action"}],columnDefs:[{orderable:!1,targets:[0,1,-1]}]});function a(){e.search("").draw()}$("#table-user_filter input").off(),$("#table-user_filter input").on("keyup",(function(a){"Enter"==a.code&&e.search(this.value).draw()}));var t=document.getElementById("btn-userReload");function r(){$("#modalFormInput").modal({show:!0,backdrop:"static",keyboard:!1})}function o(){$("#modalFormInput").modal("hide"),$("#formUser")[0].reset(),$("#formUser").attr("action",base_url+"/user"),$("#role").val("").trigger("change"),$('[name="_method"]').remove(),$("#imageReview").attr("src",base_url+"/images/no-image.png"),$("#linkFoto").attr("href",base_url+"/images/no-image.png"),$("#modalFormInputLabel").html('<i class="fas fa-user-plus"></i>&nbsp; Add User')}t&&t.addEventListener("click",(function(){a()})),$("#inputFoto").on("change",(function(){!function(e,a,t){if(e.files&&e.files[0]){var r=new FileReader;r.onload=function(r){$("#"+a).attr("src",r.target.result),$("#"+t).attr("href",r.target.result),$(e).next(".custom-file-label").html(e.files[0].name)},r.readAsDataURL(e.files[0])}}(this,"imageReview","linkFoto")})),$(".openForm").on("click",(function(){r()})),$(".closeForm").on("click",(function(){o()})),$("#role").select2({theme:"bootstrap4",placeholder:"Select Role",allowClear:!0}),$("#formUser").on("submit",(function(e){e.preventDefault(),Swal.fire({imageUrl:base_url+"/images/loading.gif",imageHeight:300,showConfirmButton:!1,title:"Loading ...",allowOutsideClick:!1});var t=new FormData($("#formUser")[0]),r=$("#formUser").attr("action");$.ajax({url:r,type:"POST",data:t,contentType:!1,processData:!1,dataType:"JSON",success:function(e){Swal.fire({icon:"success",title:e.meta.message,showConfirmButton:!1,timer:2e3,allowOutsideClick:!1}).then((function(){var t=e.data.user;1==e.data.self&&($("#userImageSide").attr("src",base_url+"/storage/"+t.foto),$("#userNameSide").html(t.name)),a(),o()}))},error:function(e,a,t){if(e.responseJSON.data.errorValidator){var r=e.responseJSON.data.errorValidator,o=e.responseJSON.message,n="";$.each(r,(function(e,a){n+="<li>"+a+"</li>"})),Swal.fire({icon:"error",title:o,html:'<div class="alert alert-danger text-left" role="alert"><ul>'+n+"</ul></div>",footer:"Pastikan data yang anda masukkan sudah benar!",allowOutsideClick:!1,showConfirmButton:!0})}else{o=e.responseJSON.meta.message;var i=e.responseJSON.data;Swal.fire({icon:"error",title:o+" <br>Copy error dan hubungi Programmer!",html:'<div class="alert alert-danger text-left" role="alert"><p>Error Message: <strong>'+o+"</strong></p><p>Error: "+i.error+"</p></div>",allowOutsideClick:!1,showConfirmButton:!0})}}})})),$("#table-user").on("click",".btn-edit",(function(){Swal.fire({imageUrl:base_url+"/images/loading.gif",imageHeight:300,showConfirmButton:!1,title:"Loading ...",allowOutsideClick:!1});var e=$(this).data("id"),a=base_url+"/user/"+e+"/edit";$.ajax({url:a,type:"get",success:function(e){var a=e.data.user;$("#formUser").attr("action",e.data.action),$('<input name="_method" value="patch">').attr("type","hidden").appendTo("#formUser"),$("#modalFormInputLabel").html('<i class="fas fa-edit"></i>&nbsp; Edit User'),$("#imageReview").attr("src",a.foto),$("#linkFoto").attr("href",a.foto),$('[name="nama"]').val(a.name),$('[name="username"]').val(a.username),$('[name="email"]').val(a.email),$("#role").val(a.role).trigger("change"),r(),Swal.close()},error:function(e,a,t){var r=e.responseJSON.meta,o=e.responseJSON.data;Swal.fire({icon:"error",title:r.message,html:'<div class="alert alert-danger text-left" role="alert"><p>'+o.error+"</p></div>",allowOutsideClick:!1})}})})),$("#table-user").on("click",".btn-delete",(function(){var e=this;o(),Swal.fire({title:"Anda yakin?",text:"Anda yakin ingin menghapus data?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",allowOutsideClick:!1}).then((function(t){if(t.value){Swal.fire({imageUrl:base_url+"/images/loading.gif",imageHeight:300,showConfirmButton:!1,title:"Loading ...",allowOutsideClick:!1});var r=$(e).data("id"),o=base_url+"/user/"+r+"/delete";$.ajax({url:o,type:"POST",data:{_method:"delete"},dataType:"JSON",success:function(e){Swal.fire({icon:"success",title:e.data.message,showConfirmButton:!1,timer:2e3,allowOutsideClick:!1}).then((function(){a()}))},error:function(e,a,t){var r=e.responseJSON;if(r.meta)var o=r.meta.message;else o=r.message;Swal.fire({icon:"error",title:o,showConfirmButton:!1,timer:2e3,allowOutsideClick:!1})}})}}))}))}));
//# sourceMappingURL=user.js.map