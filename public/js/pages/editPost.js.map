{"version":3,"sources":["webpack:///./resources/js/pages/editPost.js"],"names":["$","ajaxSetup","headers","attr","fn","modal","Constructor","prototype","_enforceFocus","tinymce","init","height","selector","plugins","toolbar","file_picker_callback","callback","value","meta","x","window","innerWidth","document","documentElement","clientWidth","getElementsByTagName","y","innerHeight","clientHeight","cmsURL","fieldname","filetype","tinyMCE","activeEditor","windowManager","openUrl","url","title","width","resizable","close_previous","onMessage","api","message","content","select2","theme","placeholder","allowClear","filemanager","minimumInputLength","multiple","tags","ajax","base_url","dataType","quietMillis","data","params","search","term","processResults","results","on","res","idPost","val","tagsSelect","type","then","option","each","inTag","valTag","Option","text","id","append","trigger","publishedDate","moment","datetimepicker","minDate","format","sideBySide","icons","time","date","useCurrent","e","preventDefault","Swal","fire","imageUrl","imageHeight","showConfirmButton","allowOutsideClick","formData","FormData","contentType","processData","success","icon","timer","location","replace","error","jqXHR","textStatus","errorThrown","responseJSON","errorValidator","errors","li","key","html","footer"],"mappings":"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","file":"/js/pages/editPost.js","sourcesContent":["$(function () {\n    $.ajaxSetup({\n        headers: {\n            \"X-CSRF-TOKEN\": $('meta[name=\"csrf-token\"').attr(\"content\"),\n        },\n    });\n    $.fn.modal.Constructor.prototype._enforceFocus = function () {};\n\n    tinymce.init({\n        height: \"1000\",\n        selector: \"textarea#content\", // Replace this CSS selector to match the placeholder element for TinyMCE\n        plugins:\n            \"advlist code table lists autolink link image charmap preview anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template\",\n\n        toolbar:\n            \"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | \" +\n            \"bullist numlist outdent indent | link image | print preview media fullscreen | \" +\n            \"forecolor backcolor emoticons | help\",\n        file_picker_callback: function (callback, value, meta) {\n            var x =\n                window.innerWidth ||\n                document.documentElement.clientWidth ||\n                document.getElementsByTagName(\"body\")[0].clientWidth;\n            var y =\n                window.innerHeight ||\n                document.documentElement.clientHeight ||\n                document.getElementsByTagName(\"body\")[0].clientHeight;\n\n            var cmsURL = \"/filemanager?editor=\" + meta.fieldname;\n            if (meta.filetype == \"image\") {\n                cmsURL = cmsURL + \"&type=Images\";\n            } else {\n                cmsURL = cmsURL + \"&type=Files\";\n            }\n\n            tinyMCE.activeEditor.windowManager.openUrl({\n                url: cmsURL,\n                title: \"Filemanager\",\n                width: x * 0.8,\n                height: y * 0.8,\n                resizable: \"yes\",\n                close_previous: \"no\",\n                onMessage: (api, message) => {\n                    callback(message.content);\n                },\n            });\n        },\n    });\n\n    $(\"#categories\").select2({\n        theme: \"bootstrap4\",\n        placeholder: \"Select Category\",\n        allowClear: true,\n    });\n\n    $(\"#inputFoto\").filemanager(\"image\");\n\n    $(\"#tags\")\n        .select2({\n            theme: \"bootstrap4\",\n            // placeholder: \"Tags\",\n            minimumInputLength: 3,\n            multiple: true,\n            allowClear: true,\n            tags: true,\n            ajax: {\n                url: base_url + \"/ajax/post/tags\",\n                dataType: \"json\",\n                quietMillis: 100,\n                data: function (params) {\n                    return {\n                        search: params.term,\n                    };\n                },\n                processResults: function (data, params) {\n                    return { results: data };\n                },\n            },\n        })\n        .on(\"select2:select\", function (res) {});\n\n    //setSelectedTags\n    var idPost = $(\"#id_post\").val();\n    var tagsSelect = $(\"#tags\");\n    $.ajax({\n        type: \"GET\",\n        url: base_url + \"/ajax/post/\" + idPost + \"/select2tagbypost\",\n    }).then(function (data) {\n        // create the option and append to Select2\n        var option;\n        $.each(data, function (inTag, valTag) {\n            option = new Option(valTag.text, valTag.id, true, true);\n            tagsSelect.append(option).trigger(\"change\");\n        });\n\n        // manually trigger the `select2:select` event\n        tagsSelect.trigger({\n            type: \"select2:select\",\n            params: {\n                data: data,\n            },\n        });\n    });\n\n    let publishedDate = moment($(\"#inputPublishedDate\").val(), [\n        \"DD-MM-YYYY HH:mm:ss\",\n        \"YYYY-MM-DD HH:mm:ss\",\n    ]);\n\n    $(\"#published_date\").datetimepicker({\n        minDate: moment(publishedDate).format(\"YYYY-MM-DD HH:mm:ss\"),\n        sideBySide: true,\n        icons: {\n            time: \"far fa-clock\",\n            date: \"far fa-calendar-alt\",\n        },\n        date: publishedDate,\n        format: \"DD-MM-YYYY HH:mm:ss\",\n        useCurrent: false,\n    });\n\n    $(\"#formPost\").on(\"submit\", function (e) {\n        e.preventDefault();\n        Swal.fire({\n            imageUrl: base_url + \"/images/loading.gif\",\n            imageHeight: 300,\n            showConfirmButton: false,\n            title: \"Loading ...\",\n            allowOutsideClick: false,\n        });\n        var formData = new FormData($(\"#formPost\")[0]);\n        var url = $(\"#formPost\").attr(\"action\");\n        $.ajax({\n            url: url,\n            type: \"POST\",\n            data: formData,\n            contentType: false,\n            processData: false,\n            dataType: \"JSON\",\n            success: function (data) {\n                Swal.fire({\n                    icon: \"success\",\n                    title: data.meta.message,\n                    showConfirmButton: false,\n                    timer: 2000,\n                    allowOutsideClick: false,\n                }).then(function () {\n                    window.location.replace(\"/post\");\n                });\n            },\n            error: function (jqXHR, textStatus, errorThrown) {\n                if (jqXHR.responseJSON.data.errorValidator) {\n                    var errors = jqXHR.responseJSON.data.errorValidator;\n                    var message = jqXHR.responseJSON.message;\n                    var li = \"\";\n                    $.each(errors, function (key, value) {\n                        li += \"<li>\" + value + \"</li>\";\n                    });\n\n                    Swal.fire({\n                        icon: \"error\",\n                        title: message,\n                        html:\n                            '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                            \"<ul>\" +\n                            li +\n                            \"</ul>\" +\n                            \"</div>\",\n                        footer: \"Pastikan data yang anda masukkan sudah benar!\",\n                        allowOutsideClick: false,\n                        showConfirmButton: true,\n                    });\n                } else {\n                    var message = jqXHR.responseJSON.meta.message;\n                    var data = jqXHR.responseJSON.data;\n\n                    Swal.fire({\n                        icon: \"error\",\n                        title:\n                            message + \" <br>Copy error dan hubungi Programmer!\",\n                        html:\n                            '<div class=\"alert alert-danger text-left\" role=\"alert\">' +\n                            \"<p>Error Message: <strong>\" +\n                            message +\n                            \"</strong></p>\" +\n                            \"<p>Error: \" +\n                            data.error +\n                            \"</p>\" +\n                            \"</div>\",\n                        allowOutsideClick: false,\n                        showConfirmButton: true,\n                    });\n                }\n            },\n        });\n    });\n}); // ./end document\n"],"sourceRoot":""}